<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lab-1_AGH_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab-1_AGH_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="lab-1_AGH_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="lab-1_AGH_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="lab-1_AGH_files/libs/quarto-html/popper.min.js"></script>
<script src="lab-1_AGH_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab-1_AGH_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab-1_AGH_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab-1_AGH_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab-1_AGH_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab-1_AGH_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab-1_AGH_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 01</h1>
<p class="subtitle lead">BIOS 600 - Spring 2025</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Due Friday, Jan 16 at 11:59pm.</p>
<section id="welcome" class="level1">
<h1>Welcome</h1>
<section id="meet-the-tas" class="level2">
<h2 class="anchored" data-anchor-id="meet-the-tas">Meet the TAs</h2>
<p><img src="images/lab-1/hello-sticker.jpeg" class="img-fluid" width="300"></p>
<ul>
<li><p>Alex Akushevich, PhD student</p></li>
<li><p>Abby Foes, PhD student</p></li>
</ul>
</section>
<section id="what-to-expect-in-lab" class="level2">
<h2 class="anchored" data-anchor-id="what-to-expect-in-lab"><strong>What to expect in lab</strong></h2>
<ul>
<li><p>Introduction to the lab assignment (~ 5 - 10 minutes)</p></li>
<li><p>Work on the lab assignment (feel free to collaborate, but labs will be turned in individually. Ensure you understand everything you’re turning in!)</p></li>
<li><p>Lab instructions will always be posted on the Canvas homepage (under “Labs” column)</p></li>
</ul>
</section>
<section id="tips" class="level2">
<h2 class="anchored" data-anchor-id="tips"><strong>Tips</strong></h2>
<ul>
<li><p>You do not have to finish the lab in class, they will always be due the following <strong>Friday at 11:59 pm</strong>.</p></li>
<li><p>One work strategy is to get through portions that you think will be most challenging (which initially might be the coding component) during lab when a TA can help you on the spot and leave the narrative writing until later.</p></li>
</ul>
</section>
<section id="a-quick-note" class="level2">
<h2 class="anchored" data-anchor-id="a-quick-note">A quick note</h2>
<ul>
<li><p>Today’s lab introduces the computing tools we will be using this semester.</p></li>
<li><p>We will begin by installing R and RStudio, and familiarizing ourselves with its basic functionality.</p></li>
<li><p>We will also introduce Quarto as a tool to create high-quality reproducible reports - don’t worry, a fillable template is provided.</p></li>
</ul>
<p><strong>This is an individual lab. Your TAs will guide you through the first portion of the lab (until the “On your own” section).</strong></p>
<ul>
<li>Also note that the process of installing R/RStudio on individual computers sometimes takes troubleshooting. If you get stuck, don’t worry - TAs are here to help! We will also have an office hour later in the week to provide assistance with installation.</li>
</ul>
</section>
<section id="installing-r" class="level2">
<h2 class="anchored" data-anchor-id="installing-r">Installing R</h2>
<section id="what-is-r" class="level3">
<h3 class="anchored" data-anchor-id="what-is-r">What is R?</h3>
<p>R is a statistical programming language used for computation, data analysis, and graphics generation. It is widely used by statisticians, data scientists, and applied researchers in many fields.</p>
</section>
<section id="benefits-of-r" class="level3">
<h3 class="anchored" data-anchor-id="benefits-of-r">Benefits of R</h3>
<ul>
<li><p>flexible and freely available to the public, who have in turn written many user-contributed <strong>packages</strong> which provide additional functionality.</p></li>
<li><p>RStudio is a convenient interface for R that adds convenient features, such as exporting output in nice formats.</p></li>
<li><p>In this class, we’ll be doing all of our computation in RStudio.</p></li>
</ul>
<p>Let’s begin by installing R and RStudio. R is like the “engine” and RStudio is like the “dashboard”, so we need both.</p>
<p>First, we need to install R, which can be <a href="https://cran.r-project.org/">downloaded here</a> (see screenshot below).</p>
<p><img src="images/lab-1/r1.png" class="img-fluid"></p>
<p>Next, install RStudio Desktop, which can be <a href="https://posit.co/download/rstudio-desktop/">downloaded here</a> (see screenshot below).</p>
<p><img src="images/lab-1/r2.png" class="img-fluid"></p>
</section>
</section>
<section id="first-steps-in-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="first-steps-in-rstudio">First Steps in RStudio</h2>
<section id="ensure-you-have-an-updated-version" class="level3">
<h3 class="anchored" data-anchor-id="ensure-you-have-an-updated-version">Ensure you have an updated version</h3>
<p>For this course, we’ll be using Quarto to type up HW/Labs. Quarto is a (relatively new) publishing system which may be accessed through RStudio. Some of you may already have R/RStudio installed on your computer. To ensure you have a version of RStudio which can run Quarto, follow these instructions:</p>
<ul>
<li><p>For Windows: Go to Help &gt; About RStudio.</p></li>
<li><p>For Mac: Go to RStudio &gt; About RStudio.</p></li>
<li><p>The dialogue box will display the RStudio version. <strong>You should have version 2022.07 or later</strong>.</p></li>
</ul>
</section>
<section id="what-if-i-have-an-earlier-version-of-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="what-if-i-have-an-earlier-version-of-rstudio">What if I have an earlier version of RStudio?</h3>
<p>You’ll need to update. To update RStudio, first check if an update is available by going to Help &gt; Check for Updates within RStudio (there should be one available). If an update is found (it should be), you’ll be directed to the RStudio website to download the latest version. After downloading, run the installer and follow the prompts to install the new version.</p>
</section>
</section>
<section id="exploring-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="exploring-rstudio">Exploring RStudio</h2>
<p>With R and RStudio installed, we’ll begin by exploring RStudio: the interface, reading in data, and basic commands. Upon opening RStudio, you should see something similar to the window below:</p>
<p><img src="images/lab-1/r3.png" class="img-fluid"></p>
<p>The <strong>console</strong> is the panel on the left side, and is where users can type commands and see immediate output. Let’s try it out! Type the following code into the console:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You should get output that looks like</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>(For now, ignore the <code>[1]</code>). By typing in <code>3+5</code>, we got the expected answer, <code>8</code>. We can see that R can be used as a calculator directly in the console. Try some other commands that use R as a calculator. For instance, <code>3*25</code>, <code>exp(2)</code>, or <code>(10+5^2)/sqrt(40)</code>. Of course, R is not simply a calculator; other commands may also be entered here.</p>
<p>To illustrate, let’s load a dataset. Enter the following command into the console (you can directly copy/paste it, but make sure everything is exactly as below):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cdc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://aggreenbean.github.io/Bios600/labs/data/cdc_cleaned.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We’ve just loaded a dataset named <code>cdc</code>. These data come primarily from the Sortable Risk Factors and Health Indicators dataset from the CDC, which comprises demographic and health indices compiled from various federal sources. This dataset is now part of our <strong>environment</strong>, which is displayed on the top half and right side of the RStudio window.</p>
<ul>
<li><p>The <strong>environment</strong> contains all objects in the current working space. These objects could be variables, lists of variables, or even entire datasets.</p></li>
<li><p>In the same location as the environment tab, the <strong>history</strong> tab displays all commands used during the current session (don’t worry about the connections tab for now).</p></li>
<li><p>Finally, the bottom half of the right-hand panel shows information regarding files on your hard drive, installed packages, output such as plots, and help files or other documents.</p></li>
</ul>
<p>Coming back to the dataset we loaded in, we can see that it is named <code>cdc</code>. We can take a look at this dataset in a spreadsheet-like window by clicking on <code>cdc</code> in the Environment tab to the right, or by running the following code in the console:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(cdc)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Note that other objects may be added to the environment, either from external data sources from the internet as in today’s example, datasets downloaded to your computer, or even as created as manipulations of existing datasets.</p>
</section>
<section id="setting-up-a-project-in-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-a-project-in-rstudio">Setting up a project in RStudio</h2>
<p>In this class, you’ll use RStudio Projects to stay organized. A project keeps all of your work (scripts, data, and results) together in one place. This is good practice for reproducible research.</p>
<p><strong>1. What is a working directory?</strong></p>
<ul>
<li><p>The working directory is the folder where R looks for files and saves results.</p></li>
<li><p>Think of it as R’s “current location” on your computer.</p></li>
<li><p>If you try to load a dataset, R will look in your working directory first.</p></li>
</ul>
<p>Check your current working directory by running the following in your <strong>Console</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>2. Creating a project</strong></p>
<p>We’ll create a new project for this course so everything stays in one place. In RStudio, go to the top menu. Click on File → New Project → New Directory → New Project. Name your project something sensible &amp; concise, like: <code>bios600</code>. Choose where on your computer you want this folder saved (e.g., “Documents” or “Desktop”).</p>
<p>Now RStudio will automatically set your project folder as the working directory whenever you open it.</p>
<p><strong>3. Creating a “data” folder</strong></p>
<p>Inside your new project folder, we’re going to create a folder called <code>data</code>.This is where you’ll put all datasets for the course. You can make the folder by doing the following: In your computer’s file explorer (right click → New Folder → name it <code>data</code>). Alternatively, click the little folder with a green plus on your lower right pane within RStudio to create the folder.</p>
</section>
<section id="quarto-and-reproducible-research" class="level2">
<h2 class="anchored" data-anchor-id="quarto-and-reproducible-research">Quarto and reproducible research</h2>
<p>Quarto is a system that may be used to create easy-to-write, attractive reports, presentations, or webpages that also serve as reproducible records of the data analysis. These reports have the desirable property of being able to not only display written narratives and figures, but also include any R code and the outputs from these code snippets.</p>
<p>One of the biggest strengths of Quarto is that everything is in one place, and that other users should be able to reproduce your results exactly, if they have your Quarto document and datasets - the analysis is run from the beginning each time you render the document. As well, formatting is easy! Luckily, RStudio already comes with Quarto support, so there is nothing additional to install. (Again, you need &gt;= version 2022.07 to run Quarto within RStudio!)</p>
<p>Every homework assignment and lab in this class will be written in Quarto, with a template provided for you to use for the first few assignments. This lab’s template can be downloaded by typing in the following code in the Console:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://aggreenbean.github.io/Bios600/labs/lab1-template_AGH.qmd"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile=</span><span class="st">"lab-01.qmd"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You should now see the new file <code>lab-01.qmd</code> under the Files tab in the bottom-right hand side of your RStudio window. Click on <code>lab-01.qmd</code> in this window in order to open it up – it is the template for use in this lab!</p>
<p>First, put your name in the space at the top where it says “YOUR NAME GOES HERE”.</p>
<p>Fill in answers in the spaces provided: text narrative should be typed directly in the document and any included R code should be typed inside “chunks,” or sections defined by three backticks (the little mark on the same key as the tilde). See the template for more instructions, or ask your TA.</p>
<p>An important thing to note is that the workspace of the Quarto document is separate from the console – this means that you must load any packages inside of R chunks if you want to use functions contained in them. In the template for this lab, this has been done already, but in the future you may have to do it yourself.</p>
<p>In order to turn this template into a shareable document, <strong>Render</strong> the quarto template into an HTML document by pressing the Render button at the top of the document (it is a large blue arrow facing the right). You should see the template rendered as an .html file! To turn it in, print to PDF from your browser. (I recommend Google Chrome.)</p>
</section>
<section id="at-the-end-heres-how-youll-turn-this-in" class="level2">
<h2 class="anchored" data-anchor-id="at-the-end-heres-how-youll-turn-this-in">At the end, here’s how you’ll turn this in:</h2>
<ul>
<li><p>“Render” the .qmd file to an html file, by clicking on the blue right arrow button at the top of this window. (Demo)</p></li>
<li><p>Open the .html document in any browser, and print to pdf. You’ll turn in the .pdf file to Gradescope under Lab 1 Assignments.</p></li>
</ul>
</section>
</section>
<section id="on-your-own" class="level1">
<h1>On your own</h1>
<section id="exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1">Exercise 1</h2>
<p>R has various useful datasets built-in. One of these datasets is the <code>mtcars</code> dataset, extracted from the 1974 <em>Motor Trend</em> US magazine. One way we can ask for help in R, and to find out information about the data, is by typing the <code>?</code> in the console. Type <code>?mtcars</code> in the Console to view the help page for the <code>mtcars</code> dataset.</p>
<p>List three variables from this dataset, along with their units.</p>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<p>In the space provided, explain what you think ### in front of text (not code) does.</p>
</section>
<section id="exercise-3" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3">Exercise 3</h2>
<p>Write a quick one paragraph intro about yourself. Be creative!</p>
</section>
<section id="exercise-4" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4">Exercise 4</h2>
<p>In the R chunk, pick your two favorite numbers and add them together using R’s built-in calculator function. The answer should be knit directly in the document.</p>
</section>
<section id="from-.html-to-.pdf" class="level2">
<h2 class="anchored" data-anchor-id="from-.html-to-.pdf">From .html to .pdf</h2>
<p>Important: You must turn in a .pdf file corresponding to the Quarto template to Gradescope in order to receive credit for the assignment.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>